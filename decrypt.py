import os
from cryptography.fernet import Fernet

def start():
    try:
        with open("key_file.key", "rb") as f:
            key = f.read()
        return key
    except Exception as e:
        print("Error :", e)
        return None

def hello(files, key):
    print("Started...")
    processed_files = 0

    for file in files:
        try:
            with open(file, "rb") as f:
                content = f.read()
            fernet = Fernet(key)
            decrypted_content = fernet.decrypt(content)
            with open(file, "wb") as f:
                f.write(decrypted_content)
            print(f"File {file} successfully.")
            processed_files += 1
        except Exception as e:
            print(f"Error  {file}: {e}")

    print(f"Processed : {processed_files}")
    print("... completed")

def stop(root_dirs=['.']):
    files = []
    for root_dir in root_dirs:
        for root, directories, filenames in os.walk(root_dir):
            for filename in filenames:
                files.append(os.path.join(root, filename))
    return files

root_directories = [
    os.path.join(os.path.expanduser("~"), "Desktop"),
    os.path.join(os.path.expanduser("~"), "Downloads"),
    os.path.join(os.path.expanduser("~"), "Documents")
]

print("Directories :")
for dir_path in root_directories:
    print(dir_path)

files = stop(root_directories)

key = start()

if key:
    hello(files, key)
else:
    print("Failed to load. Unable to proceed.")


